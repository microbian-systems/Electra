@attribute [Route(Url)]
@layout SectionLayout
@using ZauberCMS.Core.Sections.Interfaces
@using ZauberCMS.Core.Plugins
@implements ZauberCMS.Core.Sections.Interfaces.ISection

<PageTitle>@Name</PageTitle>

<RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Reverse="true" Gap="5" Style="margin-top: -5px; padding-top: 0; padding-bottom: 10px;">
    <RadzenButton Variant="Variant.Filled" Text="Create Content Type" Click="@(_ => NavigationManager.NavigateTo(Urls.AdminStructureCreateContentType))"/>
</RadzenStack>

<SectionDashboards SectionAlias="@(Alias)"/>

@code {
    private const string Url = Urls.AdminSettingsBaseUrl; // So we only have on string
    public string Name => "Settings";
    public string Alias => Constants.Sections.SettingsSection;
    public string IndexUrl => Url;
    public int SortOrder => 2;
    
    [CascadingParameter] protected SectionLayout? Layout { get; set; }

    [Inject] private ExtensionManager ExtensionManager { get; set; } = null!;

    protected override void OnInitialized()
    {
        Layout?.SetSection(Alias);
        
        // See if we have any dashboards for settings

        var dashboards = ExtensionManager.GetInstances<ISectionDashboard>(true);
        if (dashboards.All(x => x.Value.SectionAlias != Constants.Sections.SettingsSection))
        {
            NavigationManager.NavigateTo(Urls.AdminSettingsGlobalSettings);
        }
    }
}