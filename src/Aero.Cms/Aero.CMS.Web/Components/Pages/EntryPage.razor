@page "/{*slug}"
@inject IPageService PageService
@inject IBlockRegistry BlockRegistry

@if (_content is not null)
{
    <PublicPageView Page="_content" />
}
else if (_loaded)
{
    <h1 class="text-center py-20 text-gray-500">404 - Page not found</h1>
}
else
{
    <p>Loading...</p>
}

@code {
    [Parameter] public string? Slug { get; set; }
    private ContentDocument? _content;
    private bool _loaded;

    protected override async Task OnInitializedAsync()
    {
        var slug = "/" + (Slug ?? "");
        if (slug == "/")
            slug = "/home";
        
        _content = await PageService.GetBySlugAsync(slug);
        _loaded = true;
    }
}
